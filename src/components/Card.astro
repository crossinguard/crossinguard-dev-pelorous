---
import type { HTMLAttributes } from "astro/types";

interface Props extends HTMLAttributes<"div"> {
    title: string;
    description: string;
    href: string;
    image?: {
        src: string;
        alt: string;
    };
    pubDate?: Date;
    tags?: string[];
    featured?: boolean;
}

const {
    title,
    description,
    href,
    image,
    pubDate,
    tags,
    featured = false,
    class: className,
    ...attrs
} = Astro.props;
---

<div
    class:list={["card", { "card--featured": featured }, className]}
    {...attrs}
>
    {
        image && (
            <img
                src={image.src}
                alt={image.alt}
                class="card__image"
                loading="lazy"
                decoding="async"
            />
        )
    }

    <div class="card__content">
        {
            tags && tags.length > 0 && (
                <span class="card__category">{tags[0]}</span>
            )
        }

        {
            pubDate && (
                <time class="card__date" datetime={pubDate.toISOString()}>
                    {pubDate.toLocaleDateString("en-US", {
                        day: "numeric",
                        month: "short",
                        year: "numeric",
                    })}
                </time>
            )
        }

        <h3 class="card__title">
            <a href={href} class="card__link">{title}</a>
        </h3>

        <p class="card__description">{description}</p>
    </div>
</div>

<style>
    .card {
        background: var(--color-light, #fff);
        border: 1px solid var(--color-dark, #000);
        border-radius: 12px;
        padding: 24px;
        box-shadow: 8px 8px 0px var(--color-dark, #000);
        transition: all 0.2s ease;
        container-type: inline-size;
        max-width: 384px;
        height: fit-content;
    }

    .card:hover {
        box-shadow: 16px 16px 0px var(--color-dark, #000);
        transform: translate(-4px, -4px);
    }

    .card--featured {
        max-width: 100%;
        margin-bottom: 2rem;
    }

    .card__image {
        width: 100%;
        height: 200px;
        object-fit: cover;
        border-radius: 8px;
        margin-bottom: 24px;
    }

    .card__content {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .card__category {
        background: var(--color-primary, #f4d04e);
        color: var(--color-dark, #000);
        padding: 4px 12px;
        border-radius: 4px;
        font-size: 0.875rem;
        font-weight: 800;
        width: fit-content;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .card__date {
        font-size: 0.875rem;
        color: var(--color-dark, #000);
        font-weight: 500;
    }

    .card__title {
        margin: 0;
        font-size: clamp(1.25rem, 4cqi, 1.5rem);
        font-weight: 800;
        line-height: 1.2;
        color: var(--color-dark, #000);
    }

    .card__link {
        text-decoration: none;
        color: inherit;
        transition: color 0.2s ease;
    }

    .card__link:hover,
    .card__link:focus-visible {
        color: var(--color-primary, #f4d04e);
        outline: 2px solid var(--color-primary, #f4d04e);
        outline-offset: 2px;
    }

    .card__description {
        margin: 0;
        font-size: 1rem;
        line-height: 1.5;
        color: var(--color-mid, #7c7c7c);
    }

    .card--featured .card__title {
        font-size: clamp(1.5rem, 6cqi, 2rem);
    }

    .card--featured .card__description {
        font-size: 1.125rem;
    }

    @container (max-width: 300px) {
        .card {
            padding: 20px;
        }

        .card__image {
            height: 160px;
            margin-bottom: 20px;
        }
    }
</style>
